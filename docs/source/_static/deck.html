<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>deck.js</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>deck.js</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kd">function</span> <span class="nx">AutocompleteDeck</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;input[type=text].autocomplete&#39;</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;select.valueSelect&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">payload</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.json_payload&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">deck</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.deck&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addTemplate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.add_template .result&#39;</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">getValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initializeAutocomplete</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">autocomplete</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">yourlabs_autocomplete</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">autocompleteOptions</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bindSelectOption</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;selectOption&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">option</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
                <span class="k">return</span> <span class="c1">// placeholder: create option here</span>

            <span class="kd">var</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="s1">&#39;.autocomplete_light_widget&#39;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">deck</span> <span class="o">=</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">();</span>

            <span class="nx">deck</span><span class="p">.</span><span class="nx">selectOption</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">freeDeck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Remove an item if the deck is already full</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">remove</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">children</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option[data-value=&#39;</span><span class="o">+</span><span class="nx">remove</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-value&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span>
                <span class="s1">&#39;selected&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
            <span class="nx">remove</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">updateDisplay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option:selected&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addToDeck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;[data-value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>Might be necessary for created values.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-value&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-value&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;span class=&quot;remove&quot;&gt;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.remove&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addToSelect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option[value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">option</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span>
                <span class="s1">&#39;&lt;option selected=&quot;selected&quot; value=&quot;&#39;</span><span class="o">+</span> <span class="nx">value</span> <span class="o">+</span><span class="s1">&#39;&quot;&gt;&lt;/option&gt;&#39;</span><span class="p">);</span>
            <span class="nx">option</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option[value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">option</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;selected&#39;</span><span class="p">,</span> <span class="s1">&#39;selected&#39;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">selectOption</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Get the value for this result.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">freeDeck</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addToDeck</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addToSelect</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">updateDisplay</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">deselectOption</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option[value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">autocompletId</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">autocompleteOptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">channel</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
        <span class="nx">id</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">autocompletId</span><span class="p">,</span>
        <span class="nx">iterablesSelector</span><span class="o">:</span> <span class="s1">&#39;.result&#39;</span><span class="p">,</span>
        <span class="nx">minCharacters</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">min_characters</span><span class="p">,</span>
        <span class="nx">outerContainerClasses</span><span class="o">:</span> <span class="s1">&#39;autocomplete_light_widget&#39;</span><span class="p">,</span>
        <span class="nx">defaultValue</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">placeholder</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.result&#39;</span><span class="p">);</span>

        <span class="nx">results</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.remove:last&#39;</span><span class="p">).</span><span class="nx">clone</span><span class="p">().</span><span class="nx">show</span><span class="p">());</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">max_items</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">initializeAutocomplete</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bindSelectOption</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">overrides</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span><span class="p">;</span>
    <span class="nx">overrides</span> <span class="o">=</span> <span class="nx">overrides</span> <span class="o">?</span> <span class="nx">overrides</span> <span class="o">:</span> <span class="p">{};</span>
    <span class="nx">id</span> <span class="o">=</span> <span class="nx">overrides</span><span class="p">.</span><span class="nx">id</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">id</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;failure: the element needs an id attribute, or an id option must be passed&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AutocompleteDeck</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">],</span> <span class="nx">overrides</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">initialize</span><span class="p">();</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-deckready&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;deckready&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">.</span><span class="nx">registry</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.autocomplete_light_widget[data-bootstrap=normal]&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">deck</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">yourlabs_deck</span><span class="p">();</span>
    <span class="p">});</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.autocomplete_light_widget .deck .remove&#39;</span><span class="p">).</span><span class="nx">live</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="s1">&#39;.autocomplete_light_widget&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">deck</span> <span class="o">=</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">yourlabs_deck</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">selector</span> <span class="o">=</span> <span class="nx">deck</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">yourlabs_autocomplete</span><span class="p">().</span><span class="nx">iterablesSelector</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parents</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
        <span class="nx">deck</span><span class="p">.</span><span class="nx">deselectOption</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">});</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>support values added directly in the select via js (ie. admin + sign)
for this, we make one timer that regularely checks for values in the select
that are not in the deck. The reason for that is that change is not triggered
when options are added like this:
$('select#id_dependencies').append(
     '<option value="9999" selected="selected">blabla</option>')</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">updateDecks</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.autocomplete_light_widget[data-deckready=1]&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">deck</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">yourlabs_deck</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">deck</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>

            <span class="kd">function</span> <span class="nx">updateValueDisplay</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">deck</span><span class="p">.</span><span class="nx">deck</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;[data-value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">deck</span><span class="p">.</span><span class="nx">addTemplate</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
                    <span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">deck</span><span class="p">.</span><span class="nx">valueSelect</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;option[value=&#39;</span><span class="o">+</span><span class="nx">value</span><span class="o">+</span><span class="s1">&#39;]&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-value&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
                    <span class="nx">deck</span><span class="p">.</span><span class="nx">selectOption</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">updateValueDisplay</span><span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">updateValueDisplay</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">updateDecks</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">updateDecks</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
